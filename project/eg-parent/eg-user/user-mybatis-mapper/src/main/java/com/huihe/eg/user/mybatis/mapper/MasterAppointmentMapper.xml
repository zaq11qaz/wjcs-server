<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.huihe.eg.user.mybatis.dao.MasterAppointmentMapper">
    <resultMap id="BaseResultMap" type="com.huihe.eg.user.model.MasterAppointmentEntity">
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="create_time" jdbcType="TIMESTAMP" property="create_time"/>
        <result column="update_time" jdbcType="TIMESTAMP" property="update_time"/>
        <result column="master_id" jdbcType="BIGINT" property="master_id"/>
        <result column="start_time" jdbcType="TIMESTAMP" property="start_time"/>
        <result column="end_time" jdbcType="TIMESTAMP" property="end_time"/>
        <result column="status" jdbcType="INTEGER" property="status"/>
        <result column="type" jdbcType="VARCHAR" property="type"/>
        <result column="offset" jdbcType="DECIMAL" property="offset"/>
        <result column="timezone_id" jdbcType="BIGINT" property="timezone_id"/>
        <result column="title" jdbcType="VARCHAR" property="title"/>
        <result column="group_id" jdbcType="BIGINT" property="group_id"/>
        <result column="cover" jdbcType="VARCHAR" property="cover"/>
        <result column="age_grade" jdbcType="VARCHAR" property="age_grade"/>
        <result column="language_level" jdbcType="VARCHAR" property="language_level"/>
        <result column="language" jdbcType="VARCHAR" property="language"/>
        <result column="group_type" jdbcType="VARCHAR" property="group_type"/>
        <result column="room_id" jdbcType="VARCHAR" property="room_id"/>
        <result column="teach_language" jdbcType="VARCHAR" property="teach_language"/>
        <result column="classroom_type" jdbcType="VARCHAR" property="classroom_type"/>
        <result column="introduction_cover" jdbcType="VARCHAR" property="introduction_cover"/>
        <result column="introduction_content" jdbcType="VARCHAR" property="introduction_content"/>
        <result column="connect_peoplenum" jdbcType="INTEGER" property="connect_peoplenum"/>
        <result column="is_recording" jdbcType="BIT" property="is_recording"/>
        <result column="service_type" jdbcType="VARCHAR" property="service_type"/>
        <result column="mechanism_id" jdbcType="BIGINT" property="mechanism_id"/>
        <result column="amout" jdbcType="DECIMAL" property="amout"/>
        <result column="discount" jdbcType="DECIMAL" property="discount"/>
        <result column="discount_amout" jdbcType="DECIMAL" property="discount_amout"/>
        <result column="is_discount" jdbcType="BIT" property="is_discount"/>
        <result column="teach_program" jdbcType="VARCHAR" property="teach_program"/>
        <result column="latitude" jdbcType="DECIMAL" property="latitude"/>
        <result column="longitude" jdbcType="DECIMAL" property="longitude"/>
        <result column="recommend_type" jdbcType="INTEGER" property="recommend_type"/>
        <result column="number_of_lessons" jdbcType="INTEGER" property="number_of_lessons"/>
        <result column="identity_type" jdbcType="VARCHAR" property="identity_type"/>
        <result column="group_name" jdbcType="VARCHAR" property="group_name"/>
        <result column="is_special" jdbcType="BIT" property="is_special"/>
        <result column="is_qualified" jdbcType="BIT" property="is_qualified"/>
        <result column="is_firstpage_show" jdbcType="BIT" property="is_firstpage_show"/>
        <result column="is_appointment" jdbcType="BIT" property="is_appointment"/>
        <result column="master_set_price_id" jdbcType="BIGINT" property="master_set_price_id"/>
        <result column="profit" jdbcType="DECIMAL" property="profit"/>
        <result column="like_count" jdbcType="BIGINT" property="like_count"/>
        <result column="comment_count" jdbcType="BIGINT" property="comment_count"/>
        <result column="share_count" jdbcType="BIGINT" property="share_count"/>
        <result column="full_name" jdbcType="VARCHAR" property="full_name"/>
        <result column="reason_for_refund" jdbcType="VARCHAR" property="reason_for_refund"/>
        <result column="classroom" jdbcType="VARCHAR" property="classroom"/>
        <result column="create_type" jdbcType="VARCHAR" property="create_type"/>
        <result column="student_id" jdbcType="BIGINT" property="student_id"/>
        <result column="study_card_id" jdbcType="BIGINT" property="study_card_id"/>
        <result column="mechanism_class_id" jdbcType="BIGINT" property="mechanism_class_id"/>
        <result column="categories" jdbcType="VARCHAR" property="categories"/>
    </resultMap>
    <sql id="Base_Column_List">
        id, create_time, update_time, master_id, start_time, end_time, status, type, offset,
    timezone_id, title, group_id, cover, age_grade, language_level, language, group_type,room_id,
    classroom_type,introduction_cover,introduction_content,connect_peoplenum,is_recording,
    service_type,mechanism_id,amout,discount,discount_amout,is_discount,teach_program,
    latitude,longitude,recommend_type,identity_type,is_special,is_firstpage_show,master_set_price_id,
    profit,like_count,comment_count,share_count,group_name,full_name,student_id,is_qualified,study_card_id,
    reason_for_refund,classroom,create_type,categories,is_appointment,mechanism_class_id,number_of_lessons
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from eg_master_appointment
        where id = #{id,jdbcType=BIGINT}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        delete
        from eg_master_appointment
        where id = #{id,jdbcType=BIGINT}
    </delete>
    <delete id="deleteByMechanismClassId">
        delete
        from eg_master_appointment
        where mechanism_class_id = #{id,jdbcType=BIGINT}
        AND status = 1
    </delete>
    <insert id="insert" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity">
        insert into eg_master_appointment (id, create_time, update_time,
                                           master_id, start_time, end_time,
                                           status, type, offset,
                                           timezone_id, title, group_id,
                                           cover, age_grade, language_level,
                                           language, group_type, room_id, classroom_type,
                                           introduction_cover, introduction_content,
                                           connect_peoplenum, is_recording,
                                           service_type, mechanism_id, amout, discount,
                                           discount_amout, is_discount, teach_program,
                                           latitude, longitude, recommend_type, identity_type, is_special,
                                           master_set_price_id, profit)
        values (#{id,jdbcType=BIGINT}, #{create_time,jdbcType=TIMESTAMP}, #{update_time,jdbcType=TIMESTAMP},
                #{master_id,jdbcType=BIGINT}, #{start_time,jdbcType=TIMESTAMP}, #{end_time,jdbcType=TIMESTAMP},
                #{status,jdbcType=INTEGER}, #{type,jdbcType=VARCHAR}, #{offset,jdbcType=DECIMAL},
                #{timezone_id,jdbcType=BIGINT}, #{title,jdbcType=VARCHAR}, #{group_id,jdbcType=BIGINT},
                #{cover,jdbcType=VARCHAR}, #{age_grade,jdbcType=VARCHAR},
                #{language,jdbcType=VARCHAR}, #{group_type,jdbcType=VARCHAR}, #{room_id,jdbcType=VARCHAR},
                #{classroom_type,jdbcType=VARCHAR},
                #{introduction_cover,jdbcType=VARCHAR}, #{introduction_content,jdbcType=VARCHAR},
                #{connect_peoplenum,jdbcType=INTEGER}, #{is_recording,jdbcType=BIT},
                #{service_type,jdbcType=VARCHAR}, #{mechanism_id,jdbcType=BIGINT}, #{amout,jdbcType=DECIMAL}
                   , #{discount,jdbcType=DECIMAL}, #{discount_amout,jdbcType=DECIMAL}, #{is_discount,jdbcType=BIT}
                   , #{teach_program,jdbcType=VARCHAR,}, #{latitude,jdbcType=DECIMAL}, #{longitude,jdbcType=DECIMAL},
                #{recommend_type,jdbcType=INTEGER}, #{identity_type,jdbcType=VARCHAR,}, #{is_special,jdbcType=BIT},
                #{is_firstpage_show,jdbcType=BIT}, #{master_set_price_id,jdbcType=BIGINT}, 0)
    </insert>
    <insert id="insertSelective" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity" useGeneratedKeys="true"
            keyProperty="id">
        insert into eg_master_appointment
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="create_time != null">
                create_time,
            </if>
            <if test="update_time != null">
                update_time,
            </if>
            <if test="master_id != null">
                master_id,
            </if>
            <if test="start_time != null">
                start_time,
            </if>
            <if test="end_time != null">
                end_time,
            </if>
            <if test="status != null">
                status,
            </if>
            <if test="type != null">
                type,
            </if>
            <if test="offset != null">
                offset,
            </if>
            <if test="timezone_id != null">
                timezone_id,
            </if>
            <if test="title != null">
                title,
            </if>
            <if test="group_id != null">
                group_id,
            </if>
            <if test="cover != null">
                cover,
            </if>
            <if test="age_grade != null">
                age_grade,
            </if>
            <if test="language_level != null">
                language_level,
            </if>
            <if test="language != null">
                language,
            </if>
            <if test="group_type != null">
                group_type,
            </if>
            <if test="room_id != null">
                room_id,
            </if>
            <if test="classroom_type != null">
                classroom_type,
            </if>
            <if test="introduction_cover != null">
                introduction_cover,
            </if>
            <if test="introduction_content != null">
                introduction_content,
            </if>
            <if test="connect_peoplenum != null">
                connect_peoplenum,
            </if>
            <if test="is_recording != null">
                is_recording,
            </if>
            <if test="service_type != null">
                service_type,
            </if>
            <if test="mechanism_id != null">
                mechanism_id,
            </if>
            <if test="amout != null">
                amout,
            </if>
            <if test="discount != null">
                discount,
            </if>
            <if test="discount_amout != null">
                discount_amout,
            </if>
            <if test="is_discount != null">
                is_discount,
            </if>
            <if test="teach_program != null">
                teach_program,
            </if>
            <if test="latitude != null">
                latitude,
            </if>
            <if test="longitude != null">
                longitude,
            </if>
            <if test="recommend_type != null">
                recommend_type,
            </if>
            <if test="number_of_lessons != null">
                number_of_lessons,
            </if>
            <if test="identity_type != null">
                identity_type,
            </if>
            <if test="is_special != null">
                is_special,
            </if>
            <if test="is_firstpage_show != null">
                is_firstpage_show,
            </if>
            <if test="master_set_price_id != null">
                master_set_price_id,
            </if>
            profit,
            <if test="group_name != null">
                group_name,
            </if>
            <if test="full_name != null">
                full_name,
            </if>
            <if test="classroom != null">
                classroom,
            </if>
            <if test="student_id != null">
                student_id,
            </if>
            <if test="is_qualified != null">
                is_qualified,
            </if>
            <if test="study_card_id != null">
                study_card_id,
            </if>
            <if test="mechanism_class_id != null">
                mechanism_class_id,
            </if>
            <if test="reason_for_refund != null">
                reason_for_refund,
            </if>
            <if test="create_type != null">
                create_type,
            </if>
            <if test="categories != null">
                categories,
            </if>
            <if test="is_appointment != null">
                is_appointment,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=BIGINT},
            </if>
            <if test="create_time != null">
                #{create_time,jdbcType=TIMESTAMP},
            </if>
            <if test="update_time != null">
                #{update_time,jdbcType=TIMESTAMP},
            </if>
            <if test="master_id != null">
                #{master_id,jdbcType=BIGINT},
            </if>
            <if test="start_time != null">
                #{start_time,jdbcType=TIMESTAMP},
            </if>
            <if test="end_time != null">
                #{end_time,jdbcType=TIMESTAMP},
            </if>
            <if test="status != null">
                #{status,jdbcType=INTEGER},
            </if>
            <if test="type != null">
                #{type,jdbcType=VARCHAR},
            </if>
            <if test="offset != null">
                #{offset,jdbcType=DECIMAL},
            </if>
            <if test="timezone_id != null">
                #{timezone_id,jdbcType=BIGINT},
            </if>
            <if test="title != null">
                #{title,jdbcType=VARCHAR},
            </if>
            <if test="group_id != null">
                #{group_id,jdbcType=BIGINT},
            </if>
            <if test="cover != null">
                #{cover,jdbcType=VARCHAR},
            </if>
            <if test="age_grade != null">
                #{age_grade,jdbcType=VARCHAR},
            </if>
            <if test="language_level != null">
                #{language_level,jdbcType=VARCHAR},
            </if>
            <if test="language != null">
                #{language,jdbcType=VARCHAR},
            </if>
            <if test="group_type != null">
                #{group_type,jdbcType=VARCHAR},
            </if>
            <if test="room_id != null">
                #{room_id,jdbcType=VARCHAR},
            </if>
            <if test="classroom_type != null">
                #{classroom_type,jdbcType=VARCHAR},
            </if>
            <if test="introduction_cover != null">
                #{introduction_cover,jdbcType=VARCHAR},
            </if>
            <if test="introduction_content != null">
                #{introduction_content,jdbcType=VARCHAR},
            </if>
            <if test="connect_peoplenum != null">
                #{connect_peoplenum,jdbcType=INTEGER},
            </if>
            <if test="is_recording != null">
                #{is_recording,jdbcType=BIT},
            </if>
            <if test="service_type != null">
                #{service_type,jdbcType=VARCHAR},
            </if>
            <if test="mechanism_id != null">
                #{mechanism_id,jdbcType=BIGINT},
            </if>
            <if test="amout != null">
                #{amout,jdbcType=DECIMAL},
            </if>
            <if test="discount != null">
                #{discount,jdbcType=DECIMAL},
            </if>
            <if test="discount_amout != null">
                #{discount_amout,jdbcType=DECIMAL},
            </if>
            <if test="is_discount != null">
                #{is_discount,jdbcType=BIT},
            </if>
            <if test="teach_program != null">
                #{teach_program,jdbcType=VARCHAR},
            </if>
            <if test="latitude != null">
                #{latitude,jdbcType=DECIMAL},
            </if>
            <if test="longitude != null">
                #{longitude,jdbcType=DECIMAL},
            </if>
            <if test="recommend_type != null">
                #{recommend_type,jdbcType=INTEGER},
            </if>
            <if test="number_of_lessons != null">
                #{number_of_lessons,jdbcType=INTEGER},
            </if>
            <if test="identity_type != null">
                #{identity_type,jdbcType=VARCHAR},
            </if>
            <if test="is_special != null">
                #{is_special,jdbcType=BIT},
            </if>
            <if test="is_firstpage_show != null">
                #{is_firstpage_show,jdbcType=BIT},
            </if>
            <if test="master_set_price_id != null">
                #{master_set_price_id,jdbcType=DECIMAL},
            </if>
            <if test="profit == null">
                0,
            </if>
            <if test="profit != null">
                #{profit,jdbcType=DECIMAL},
            </if>
            <if test="group_name != null">
                #{group_name,jdbcType=VARCHAR},
            </if>
            <if test="full_name != null">
                #{full_name,jdbcType=VARCHAR},
            </if>
            <if test="classroom != null">
                #{classroom,jdbcType=VARCHAR},
            </if>
            <if test="student_id != null">
                #{student_id,jdbcType=BIGINT},
            </if>
            <if test="is_qualified != null">
                #{is_qualified,jdbcType=BIT},
            </if>
            <if test="study_card_id != null">
                #{study_card_id,jdbcType=BIGINT},
            </if>
            <if test="mechanism_class_id != null">
                #{mechanism_class_id,jdbcType=BIGINT},
            </if>
            <if test="reason_for_refund != null">
                #{reason_for_refund,jdbcType=VARCHAR},
            </if>
            <if test="create_type != null">
                #{create_type,jdbcType=VARCHAR},
            </if>
            <if test="categories != null">
                #{categories,jdbcType=VARCHAR},
            </if>
            <if test="is_appointment != null">
                #{is_appointment,jdbcType=BIT},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity">
        update eg_master_appointment
        <set>
            <if test="create_time != null">
                create_time = #{create_time,jdbcType=TIMESTAMP},
            </if>
            <if test="update_time != null">
                update_time = #{update_time,jdbcType=TIMESTAMP},
            </if>
            <if test="master_id != null">
                master_id = #{master_id,jdbcType=BIGINT},
            </if>
            <if test="start_time != null">
                start_time = #{start_time,jdbcType=TIMESTAMP},
            </if>
            <if test="end_time != null">
                end_time = #{end_time,jdbcType=TIMESTAMP},
            </if>
            <if test="status != null">
                status = #{status,jdbcType=INTEGER},
            </if>
            <if test="type != null">
                type = #{type,jdbcType=VARCHAR},
            </if>
            <if test="offset != null">
                offset = #{offset,jdbcType=DECIMAL},
            </if>
            <if test="timezone_id != null">
                timezone_id = #{timezone_id,jdbcType=BIGINT},
            </if>
            <if test="title != null">
                title = #{title,jdbcType=VARCHAR},
            </if>
            <if test="group_id != null">
                group_id = #{group_id,jdbcType=BIGINT},
            </if>
            <if test="cover != null">
                cover = #{cover,jdbcType=VARCHAR},
            </if>
            <if test="age_grade != null">
                age_grade = #{age_grade,jdbcType=VARCHAR},
            </if>
            <if test="language_level != null">
                language_level = #{language_level,jdbcType=VARCHAR},
            </if>
            <if test="language != null">
                language = #{language,jdbcType=VARCHAR},
            </if>
            <if test="group_type != null">
                group_type = #{group_type,jdbcType=VARCHAR},
            </if>
            <if test="room_id != null">
                room_id = #{room_id,jdbcType=VARCHAR},
            </if>
            <if test="classroom_type != null">
                classroom_type = #{classroom_type,jdbcType=VARCHAR},
            </if>
            <if test="introduction_cover != null">
                introduction_cover = #{introduction_cover,jdbcType=VARCHAR},
            </if>
            <if test="introduction_content != null">
                introduction_content = #{introduction_content,jdbcType=VARCHAR},
            </if>
            <if test="connect_peoplenum != null">
                connect_peoplenum = #{connect_peoplenum,jdbcType=INTEGER},
            </if>
            <if test="is_recording != null">
                is_recording = #{is_recording,jdbcType=BIT},
            </if>
            <if test="service_type != null">
                service_type = #{service_type,jdbcType=VARCHAR},
            </if>
            <if test="mechanism_id != null">
                mechanism_id = #{mechanism_id,jdbcType=BIGINT},
            </if>
            <if test="amout != null">
                amout = #{amout,jdbcType=DECIMAL},
            </if>
            <if test="discount != null">
                discount = #{discount,jdbcType=DECIMAL},
            </if>
            <if test="discount_amout != null">
                discount_amout = #{discount_amout,jdbcType=DECIMAL},
            </if>
            <if test="is_discount != null">
                is_discount = #{is_discount,jdbcType=BIT},
            </if>
            <if test="teach_program != null">
                teach_program = #{teach_program,jdbcType=VARCHAR},
            </if>
            <if test="latitude != null">
                latitude = #{latitude,jdbcType=DECIMAL},
            </if>
            <if test="longitude != null">
                longitude = #{longitude,jdbcType=DECIMAL},
            </if>
            <if test="recommend_type != null">
                recommend_type = #{recommend_type,jdbcType=INTEGER},
            </if>
            <if test="number_of_lessons != null">
                number_of_lessons = #{number_of_lessons,jdbcType=INTEGER},
            </if>
            <if test="identity_type != null">
                identity_type = #{identity_type,jdbcType=VARCHAR},
            </if>
            <if test="is_special != null">
                is_special = #{is_special,jdbcType=BIT},
            </if>
            <if test="is_firstpage_show != null">
                is_firstpage_show = #{is_firstpage_show,jdbcType=BIT},
            </if>
            <if test="master_set_price_id != null">
                master_set_price_id = #{master_set_price_id,jdbcType=BIGINT},
            </if>
            <if test="profit != null">
                profit = #{profit,jdbcType=DECIMAL},
            </if>
            <if test="like_count != null">
                like_count = #{like_count,jdbcType=BIGINT},
            </if>
            <if test="comment_count != null">
                comment_count = #{comment_count,jdbcType=BIGINT},
            </if>
            <if test="share_count != null">
                share_count = #{share_count,jdbcType=BIGINT},
            </if>
            <if test="group_name != null">
                group_name = #{group_name,jdbcType=VARCHAR},
            </if>
            <if test="full_name != null">
                full_name = #{full_name,jdbcType=VARCHAR},
            </if>
            <if test="classroom != null">
                classroom = #{classroom,jdbcType=VARCHAR},
            </if>
            <if test="reason_for_refund != null">
                reason_for_refund = #{reason_for_refund,jdbcType=VARCHAR},
            </if>
            <if test="student_id != null">
                student_id = #{student_id,jdbcType=BIGINT},
            </if>
            <if test="mechanism_class_id != null">
                mechanism_class_id = #{mechanism_class_id,jdbcType=BIGINT},
            </if>
            <if test="is_qualified != null">
                is_qualified = #{is_qualified,jdbcType=BIT},
            </if>
            <if test="categories != null">
                categories = #{categories,jdbcType=VARCHAR},
            </if>
            <if test="is_appointment != null">
                is_appointment = #{is_appointment,jdbcType=BIT},
            </if>
        </set>
        where id = #{id,jdbcType=BIGINT}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity">
        update eg_master_appointment
        set create_time          = #{create_time,jdbcType=TIMESTAMP},
            update_time          = #{update_time,jdbcType=TIMESTAMP},
            master_id            = #{master_id,jdbcType=BIGINT},
            start_time           = #{start_time,jdbcType=TIMESTAMP},
            end_time             = #{end_time,jdbcType=TIMESTAMP},
            status               = #{status,jdbcType=INTEGER},
            type                 = #{type,jdbcType=VARCHAR},
            offset               = #{offset,jdbcType=DECIMAL},
            timezone_id          = #{timezone_id,jdbcType=BIGINT},
            title                = #{title,jdbcType=VARCHAR},
            group_id             = #{group_id,jdbcType=BIGINT},
            cover                = #{cover,jdbcType=VARCHAR},
            age_grade            = #{age_grade,jdbcType=VARCHAR},
            language_level       = #{language_level,jdbcType=VARCHAR},
            language             = #{language,jdbcType=VARCHAR},
            group_type           = #{group_type,jdbcType=VARCHAR},
            room_id              = #{room_id,jdbcType=VARCHAR},
            classroom_type       = #{classroom_type,jdbcType=VARCHAR},
            introduction_cover   = #{introduction_cover,jdbcType=VARCHAR},
            introduction_content = #{introduction_content,jdbcType=VARCHAR},
            connect_peoplenum    = #{connect_peoplenum,jdbcType=INTEGER},
            is_recording         = #{is_recording,jdbcType=INTEGER},
            service_type         = #{service_type,jdbcType=VARCHAR},
            mechanism_id         = #{mechanism_id,jdbcType=BIGINT},
            amout                = #{amout,jdbcType=DECIMAL},
            discount             = #{discount,jdbcType=DECIMAL},
            discount_amout       = #{discount_amout,jdbcType=DECIMAL},
            is_discount          = #{is_discount,jdbcType=BIT},
            teach_program        = #{teach_program,jdbcType=VARCHAR},
            latitude             = #{latitude,jdbcType=DECIMAL},
            longitude            = #{longitude,jdbcType=DECIMAL},
            recommend_type       = #{recommend_type,jdbcType=INTEGER},
            identity_type        = #{identity_type,jdbcType=VARCHAR},
            is_special           = #{is_special,jdbcType=BIT},
            is_firstpage_show    = #{is_firstpage_show,jdbcType=BIT},
            master_set_price_id  = #{master_set_price_id,jdbcType=BIGINT},
            profit               = #{profit,jdbcType=DECIMAL}

        where id = #{id,jdbcType=BIGINT}
    </update>
    <select id="query" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.student_id!=null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.categories!=null">
                AND categories = #{param.categories,jdbcType=VARCHAR}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
    </select>
    <select id="queryListPage" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.create_type!=null">
                AND create_type = #{param.create_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.group_name!=null">
                AND group_name = #{param.group_name,jdbcType=BIT}
            </if>
            <if test="param.student_id!=null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id!=null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id!=null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.categories!=null">
                AND categories = #{param.categories,jdbcType=VARCHAR}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
        ORDER BY is_recording DESC ,UNIX_TIMESTAMP(start_time)+(8-OFFSET*60*60) DESC limit
        #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryListPageCount" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultType="java.lang.Integer">
        SELECT
        coalesce(count(0),0)
        FROM eg_master_appointment
        <where>
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.create_type!=null">
                AND create_type = #{param.create_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.student_id!=null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id!=null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id!=null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.categories!=null">
                AND categories = #{param.categories,jdbcType=VARCHAR}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
    </select>
    <select id="querySchedule" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null and param.offset !=null and param.end_time!=null">
                AND unix_timestamp(start_time) BETWEEN
                unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
                AND unix_timestamp(#{param.end_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.type==null">
                AND (type ='single_class' or type = 'open_class' )
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.is_special != null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.student_id != null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id != null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
        ORDER BY UNIX_TIMESTAMP(start_time)+(8-OFFSET*60*60)
    </select>
    <select id="queryDaySchedule" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        where
        DAY(#{param.start_time,jdbcType=TIMESTAMP})=DAY(start_time) and
        WEEK(#{param.start_time,jdbcType=TIMESTAMP}) = WEEK(start_time)
        and MONTH(#{param.start_time,jdbcType=TIMESTAMP}) =
        MONTH(start_time) AND YEAR(#{param.start_time,jdbcType=TIMESTAMP}) = YEAR(start_time)
        <if test="param.master_id!=null">
            AND master_id = #{param.master_id,jdbcType=BIGINT}
        </if>
        <if test="param.group_id!=null">
            AND group_id = #{param.group_id,jdbcType=BIGINT}
        </if>
        <if test="param.type!=null">
            AND type = #{param.type,jdbcType=VARCHAR}
        </if>
        <if test="param.cover!=null">
            AND cover = #{param.cover,jdbcType=VARCHAR}
        </if>
        <if test="param.age_grade!=null and param.age_grade!=''">
            AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
        </if>
        <if test="param.language_level!=null and param.language_level!=''">
            AND language_level = #{param.language_level,jdbcType=VARCHAR}
        </if>
        <if test="param.language!=null and param.language!=''">
            AND language = #{param.language,jdbcType=VARCHAR}
        </if>
        <if test="param.group_type!=null and param.group_type!=''">
            AND group_type = #{param.group_type,jdbcType=VARCHAR}
        </if>
        <if test="param.room_id!=null">
            AND room_id = #{param.room_id,jdbcType=VARCHAR}
        </if>
        <if test="param.classroom_type!=null and param.classroom_type!=''">
            AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
        </if>
        <if test="param.introduction_cover!=null">
            AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
        </if>
        <if test="param.introduction_content!=null">
            AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
        </if>
        <if test="param.connect_peoplenum!=null">
            AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
        </if>
        <if test="param.is_recording!=null">
            AND is_recording = #{param.is_recording,jdbcType=BIT}
        </if>
        <if test="param.service_type!=null">
            AND service_type = #{param.service_type,jdbcType=VARCHAR}
        </if>
        <if test="param.mechanism_id!=null">
            AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
        </if>
        <if test="param.amout!=null">
            AND amout = #{param.amout,jdbcType=DECIMAL}
        </if>
        <if test="param.discount!=null">
            AND discount = #{param.discount,jdbcType=DECIMAL}
        </if>
        <if test="param.discount_amout!=null">
            AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
        </if>
        <if test="param.is_discount!=null">
            AND is_discount = #{param.is_discount,jdbcType=BIT}
        </if>
        <if test="param.teach_program!=null">
            AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
        </if>
        <if test="param.latitude!=null">
            AND latitude = #{param.latitude,jdbcType=DECIMAL}
        </if>
        <if test="param.longitude!=null">
            AND longitude = #{param.longitude,jdbcType=DECIMAL}
        </if>
        <if test="param.recommend_type!=null">
            AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
        </if>
        <if test="param.number_of_lessons!=null">
            AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
        </if>
        <if test="param.identity_type!=null">
            AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type==null">
            AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
            identity_type = '' )
        </if>
        <if test="param.master_set_price_id != null">
            AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
        </if>
        <if test="param.mechanism_class_id != null">
            AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
        </if>
        <if test="param.is_appointment!=null">
            AND is_appointment = #{param.is_appointment,jdbcType=BIT}
        </if>
    </select>
    <select id="queryAppointmentListPage" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT DISTINCT
        a.id, a.create_time, a.update_time, a.master_id, a.start_time, a.end_time, a.status, a.type, a.offset,
        a.timezone_id, a.title, a.group_id, a.cover, a.age_grade, a.language_level, a.language,
        a.group_type,a.classroom_type,
        a.introduction_cover,a.introduction_content,a.connect_peoplenum,a.is_recording,a.service_type,a.mechanism_id,
        a.amout,a.discount,a.discount_amout,a.is_discount,a.teach_program,a.latitude,a.longitude,a.recommend_type,a.identity_type
        FROM
        eg_master_appointment a,
        eg_master_info i
        <where>
            a.master_id = i.user_id
            AND a.status = 1
            <if test="param.id!=null">
                AND a.id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND a.create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND a.update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND a.master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <choose>
                <when test="param.start_time!=null and param.offset !=null and param.end_time!=null">
                    AND
                    unix_timestamp(start_time) &gt;=unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
                    AND
                    unix_timestamp(end_time) &lt;=
                    unix_timestamp(#{param.end_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
                </when>
                <when test="param.start_time!=null and param.offset !=null">
                    AND
                    unix_timestamp(a.start_time)=unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP})+(a.offset-#{param.offset,jdbcType=DECIMAL})*60*60
                </when>
                <when test="param.end_time!=null and param.offset !=null">
                    AND
                    unix_timestamp(a.end_time)=unix_timestamp(#{param.end_time,jdbcType=TIMESTAMP})+(a.offset-#{param.offset,jdbcType=DECIMAL})*60*60
                </when>
            </choose>
            <if test="param.group_id!=null">
                AND a.group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.type!=null">
                AND a.type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.teach_language!=null and param.teach_language!=''">
                AND i.teach_language LIKE concat(#{param.teach_language,jdbcType=VARCHAR},'%')
            </if>
            <if test="param.cover!=null">
                AND a.cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND a.age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND a.language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND a.language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND a.group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND a.room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND a.classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND a.introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND a.introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND a.connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND a.is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND a.service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND a.mechanism_id = #{param.mechanism_id,jdbcType=VARCHAR}
            </if>
            <if test="param.amout!=null">
                AND a.amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND a.discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND a.discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND a.is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND a.teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND a.latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND a.longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND a. recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND a.identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.is_appointment!=null">
                AND a.is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
        ORDER BY a.id DESC limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryAppointmentUpdate" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultMap="BaseResultMap">
        SELECT
        DISTINCT(master_id) AS master_id,type
        FROM eg_master_appointment
        <where>

            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null and param.offset !=null">
                AND
                unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60 >
                unix_timestamp(start_time)
            </if>
            <if test="param.end_time!=null and param.offset !=null">
                AND
                unix_timestamp(end_time) >
                unix_timestamp(#{param.end_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
        ORDER BY id DESC limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryClassListPage" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            NOW() &gt;= DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE )
            AND NOW() &lt;= DATE_ADD( end_time, INTERVAL 480- OFFSET*60 MINUTE )
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
        ORDER BY id DESC limit #{param.startRow},#{param.pageSize}
    </select>

    <!-- -->
    <select id="queryCourseCount" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultType="java.lang.Integer">
        SELECT COUNT(0) FROM eg_master_appointment
        <where>
            MONTH(start_time) =
            MONTH(CURDATE()) AND YEAR(start_time) = YEAR(CURDATE())
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
    </select>

    <!-- -->
    <select id="querySurplusCount" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultType="java.lang.Integer">
        SELECT COUNT(0)
        FROM eg_master_appointment
        WHERE start_time &gt; now()
        AND master_id = #{param.master_id,jdbcType=BIGINT}
        <if test="param.identity_type!=null">
            AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type==null">
            AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
            identity_type = '' )
        </if>
        <if test="param.master_set_price_id != null">
            AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
        </if>
        <if test="param.mechanism_class_id != null">
            AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
        </if>
        <if test="param.is_appointment!=null">
            AND is_appointment = #{param.is_appointment,jdbcType=BIT}
        </if>
    </select>
    <select id="queryLatelyCourse" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            start_time > now()
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
        limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryExpireClass" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        where
        DATE_FORMAT(now(), '%Y-%m-%d %H:%i') &gt;= DATE_FORMAT(DATE_ADD( end_time, INTERVAL 479- OFFSET*60 MINUTE
        ),'%Y-%m-%d %H:%i') and
        DATE_FORMAT(now(), '%Y-%m-%d %H:%i') &lt;= DATE_FORMAT(DATE_ADD( end_time, INTERVAL 481- OFFSET*60 MINUTE
        ),'%Y-%m-%d %H:%i')
        <!--(unix_timestamp(now())-8*60*60)=(unix_timestamp(end_time)-offset*60*60)-->
    </select>
    <select id="queryStayComment" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        where
        TYPE ='open_class' AND
        (unix_timestamp(now())-8*60*60)=(unix_timestamp(end_time)-offset*60*60)+600
    </select>
    <select id="queryClassStartPush" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        where
        TYPE ='open_class' AND (
        (
        unix_timestamp(start_time) + OFFSET * 60 * 60
        ) - (
        unix_timestamp(now()) + 8 * 60 * 60
        ) &gt; 240
        AND (
        unix_timestamp(start_time) + OFFSET * 60 * 60
        ) - (
        unix_timestamp(now()) + 8 * 60 * 60
        ) &lt; 300
        )
        OR (
        (
        unix_timestamp(start_time) + OFFSET * 60 * 60
        ) - (
        unix_timestamp(now()) + 8 * 60 * 60
        ) &gt; 3540
        AND (
        unix_timestamp(start_time) + OFFSET * 60 * 60
        ) - (
        unix_timestamp(now()) + 8 * 60 * 60
        ) &lt; 3600
        )
    </select>
    <select id="queryBeginListPage" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            DATE_ADD( end_time, INTERVAL 480- OFFSET*60 MINUTE ) > NOW()
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.master_id==null">
                AND master_id &lt;&gt; 0
            </if>
            <if test="param.start_time!=null  and param.offset!=null">
                AND unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP}) BETWEEN
                unix_timestamp(start_time)+(#{param.offset,jdbcType=DECIMAL}-offset)*60*60
                AND unix_timestamp(end_time)+(#{param.offset,jdbcType=DECIMAL}-offset)*60*60
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
        ORDER BY DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryHistoryListPage" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            NOW() > DATE_ADD(end_time, INTERVAL 480- OFFSET*60 MINUTE )
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null  and param.offset!=null">
                AND unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP}) BETWEEN
                unix_timestamp(start_time)+(#{param.offset,jdbcType=DECIMAL}-offset)*60*60
                AND unix_timestamp(end_time)+(#{param.offset,jdbcType=DECIMAL}-offset)*60*60
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
        ORDER BY DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) DESC limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryBeginListPageCount" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultType="java.lang.Integer">
        SELECT
        COALESCE(count(1),0)
        FROM eg_master_appointment
        <where>
            NOW() &lt; DATE_ADD( end_time, INTERVAL 480- OFFSET*60 MINUTE )
            AND NOW() &gt; DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE )
            AND status = 3
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
    </select>

    <select id="queryHomeListPage" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        <if test="param.latitude!=null and param.longitude!=null">
            ,(
            6371 * acos (
            cos (radians(
            #{param.latitude,jdbcType=DECIMAL}
            ))
            * cos( radians( t1.latitude ) )
            * cos( radians( t1.longitude ) - radians(
            #{param.longitude,jdbcType=DECIMAL}
            ))
            + sin ( radians(
            #{param.latitude,jdbcType=DECIMAL}
            )
            * sin( radians( t1.latitude ) )
            )
            )
            ) AS distance
        </if>
        FROM
        (
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        eg_master_appointment
        <where>
            NOW() BETWEEN DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE )
            AND DATE_ADD( end_time, INTERVAL 480- OFFSET*60 MINUTE )
            AND status = 3
            AND is_firstpage_show = true
            AND is_special = false
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.group_ids!=null and param.group_ids.size()>0">
                and group_id in
                <foreach item="group_id" index="index" collection="param.group_ids" open="(" separator="," close=")">
                    #{group_id,jdbcType=BIGINT}
                </foreach>
            </if>
        </where>
        ORDER BY
        recommend_type DESC,
        DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) DESC ) t1
        <if test="param.latitude!=null and param.longitude!=null">
            HAVING 50 > distance
        </if>
        <!--UNION ALL
            SELECT
	<include refid="Base_Column_List"/>
            FROM(
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        eg_master_appointment
        <where>
            unix_timestamp(now()) BETWEEN unix_timestamp(start_time) + (8 - OFFSET) * 60 * 60
            AND unix_timestamp(end_time) + (8 - OFFSET) * 60 * 60 and (status =1 or status =2)
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.group_ids!=null and param.group_ids.size()>0">
                and group_id in
                <foreach item="group_id" index="index" collection="param.group_ids" open="(" separator="," close=")">
                #{group_id,jdbcType=BIGINT}
                </foreach>
            </if>
        </where>
        GROUP by group_id
        ORDER BY
        UNIX_TIMESTAMP(start_time) + (8 - OFFSET * 60 * 60) desc ) t1-->

        UNION ALL
        select
        <include refid="Base_Column_List"/>
        <if test="param.latitude!=null and param.longitude!=null">
            ,(
            6371 * acos (
            cos (radians(
            #{param.latitude,jdbcType=DECIMAL}
            )
            )
            * cos( radians( t2.latitude ) )
            * cos( radians( t2.longitude ) - radians(
            #{param.longitude,jdbcType=DECIMAL}
            ))
            + sin ( radians(
            #{param.latitude,jdbcType=DECIMAL}
            ))
            * sin( radians( t2.latitude ) )
            )
            ) AS distance
        </if>
        from (
        SELECT
        <include refid="Base_Column_List"/>
        FROM(
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        eg_master_appointment
        <where>
            NOW() > DATE_ADD( end_time,INTERVAL 480- OFFSET*60 MINUTE )
            AND is_recording=1
            AND is_firstpage_show = true
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.group_ids!= null and param.group_ids.size()>0">
                and group_id in
                <foreach item="group_id" index="index" collection="param.group_ids" open="(" separator="," close=")">
                    #{group_id,jdbcType=BIGINT}
                </foreach>
            </if>
        </where>
        ORDER BY
        recommend_type DESC,
        DATE_ADD( end_time,INTERVAL 480- OFFSET*60 MINUTE) DESC
        )AS a
        GROUP by a.group_id
        ORDER BY
        recommend_type DESC,
        DATE_ADD( end_time,INTERVAL 480- OFFSET*60 MINUTE ) DESC
        ) t2
        <if test="param.latitude!=null and param.longitude!=null">
            HAVING 50 > distance
        </if>

        UNION ALL
        SELECT
        <include refid="Base_Column_List"/>
        <if test="param.latitude!=null and param.longitude!=null">
            ,(
            6371 * acos (
            cos (radians(
            #{param.latitude,jdbcType=DECIMAL}
            )
            )
            * cos( radians( t3.latitude ) )
            * cos( radians( t3.longitude ) - radians(
            #{param.longitude,jdbcType=DECIMAL}
            ))
            + sin ( radians(
            (#{param.latitude,jdbcType=DECIMAL})
            ))
            * sin( radians( t3.latitude ))
            )
            ) AS distance
        </if>
        from (
        SELECT
        <include refid="Base_Column_List"/>
        FROM(
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        eg_master_appointment
        <where>
            DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) > NOW()
            AND is_firstpage_show = true
            AND is_special = false
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.group_ids!= null and param.group_ids.size()>0">
                and group_id in
                <foreach item="group_id" index="index" collection="param.group_ids" open="(" separator="," close=")">
                    #{group_id,jdbcType=BIGINT}
                </foreach>
            </if>
        </where>
        ORDER BY
        recommend_type desc,
        DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) ASC
        )AS b
        GROUP by b.group_id
        ORDER BY
        recommend_type desc,
        DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) ASC
        )t3
        <if test="param.latitude!=null and param.longitude!=null">
            HAVING 50 > distance
        </if>
        <if test="param.latitude!=null and param.longitude!=null">
            ORDER BY distance ASC
        </if>
        limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryHistoryListPageCount" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultType="java.lang.Integer">
        SELECT
        COALESCE(count(1),0)
        FROM eg_master_appointment
        <where>
            unix_timestamp(NOW()) &gt;unix_timestamp(end_time) + (8 - OFFSET) * 60 * 60
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null  and param.offset!=null">
                AND unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP}) BETWEEN
                unix_timestamp(start_time)+(#{param.offset,jdbcType=DECIMAL}-offset)*60*60
                AND unix_timestamp(end_time)+(#{param.offset,jdbcType=DECIMAL}-offset)*60*60
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="queryMechanismAppointmentListPage" parameterType="com.huihe.eg.user.model.MasterAppointmentEntity"
            resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.status==null">
                AND status in (1,2,3)
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.type==null">
                and type='jointly_class' or type='mechanism_offline'
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        ORDER BY UNIX_TIMESTAMP(start_time)+(8-OFFSET*60*60) DESC limit #{param.startRow},#{param.pageSize}
    </select>

    <select id="queryDayCount" resultType="java.lang.Integer">
        SELECT
        COALESCE( count(1),0)
        FROM `eg_master_appointment`
        where
        date_format(end_time,'%Y-%m-%d') = date_format(now(),'%Y-%m-%d')
        <if test="param.service_type!=null">
            and service_type = #{param.service_type,jdbcType=VARCHAR}
        </if>
        <if test="param.type!=null">
            and type = #{param.type,jdbcType=VARCHAR}
        </if>
        <if test="param.master_id!=null">
            and master_id = #{param.master_id,jdbcType=BIGINT}
        </if>
        <if test="param.is_special!=null">
            and is_special = #{param.is_special,jdbcType=BIT}
        </if>
        <if test="param.mechanism_id!=null">
            AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
        </if>
        <if test="param.group_type!=null and param.group_type!=''">
            AND group_type = #{param.group_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type!=null">
            AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type==null">
            AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
            identity_type = '' )
        </if>
        <if test="param.master_set_price_id != null">
            AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
        </if>
        <if test="param.mechanism_class_id != null">
            AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
        </if>

    </select>

    <select id="queryWeekCount" resultType="java.lang.Integer">
        SELECT
        COALESCE( count(1),0)
        FROM `eg_master_appointment`
        where
        YEARWEEK(date_format(end_time,'%Y-%m-%d'),1) = YEARWEEK(now(),1)
        <if test="param.service_type!=null">
            and service_type = #{param.service_type,jdbcType=VARCHAR}
        </if>
        <if test="param.type!=null">
            and type = #{param.type,jdbcType=VARCHAR}
        </if>
        <if test="param.master_id!=null">
            and master_id = #{param.master_id,jdbcType=BIGINT}
        </if>
        <if test="param.is_special!=null">
            and is_special = #{param.is_special,jdbcType=BIT}
        </if>
        <if test="param.mechanism_id!=null">
            AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
        </if>
        <if test="param.group_type!=null and param.group_type!=''">
            AND group_type = #{param.group_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type!=null">
            AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type==null">
            AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
            identity_type = '' )
        </if>
        <if test="param.master_set_price_id != null">
            AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
        </if>
        <if test="param.mechanism_class_id != null">
            AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
        </if>
    </select>
    <select id="queryMonthCount" resultType="java.lang.Integer">
        SELECT
        COALESCE( count(1),0)
        FROM `eg_master_appointment`
        where
        end_time > date_sub(NOW(), interval 1 MONTH)
        <if test="param.service_type!=null">
            and service_type = #{param.service_type,jdbcType=VARCHAR}
        </if>
        <if test="param.type!=null">
            and type = #{param.type,jdbcType=VARCHAR}
        </if>
        <if test="param.master_id!=null">
            and master_id = #{param.master_id,jdbcType=BIGINT}
        </if>
        <if test="param.is_special!=null">
            and is_special = #{param.is_special,jdbcType=BIT}
        </if>
        <if test="param.mechanism_id!=null">
            AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
        </if>
        <if test="param.group_type!=null and param.group_type!=''">
            AND group_type = #{param.group_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type!=null">
            AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type==null">
            AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
            identity_type = '' )
        </if>
        <if test="param.master_set_price_id != null">
            AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
        </if>
        <if test="param.mechanism_class_id != null">
            AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
        </if>
    </select>
    <select id="queryCountTotal" resultType="java.lang.Integer">
        SELECT
        COALESCE( count(1),0)
        FROM `eg_master_appointment`
        <where>
            <if test="param.service_type!=null">
                and service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.type!=null">
                and type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.master_id!=null">
                and master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.is_special!=null">
                and is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="queryMasterAppointmentCount" resultType="java.lang.Integer">
        select
        COALESCE( count(1),0)
        from `eg_master_appointment`
        <where>
            <if test="param.start_time !=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.start_time ==null">
                end_time > now()
            </if>
            <if test="param.type!=null">
                and type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null">
                and language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.status!=null">
                and status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>

    <select id="queryEndClassCount" resultType="java.lang.Integer">

        SELECT
        COALESCE( count(1),0)
        FROM
        `eg_master_appointment`
        <where>
            start_time+(8-OFFSET*60*60) &lt; now()+(8-OFFSET*60*60)
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>

    </select>

    <select id="querySoonCount" resultType="java.lang.Integer">

        SELECT COALESCE( count(1),0)
        FROM`eg_master_appointment`
        <where>
            start_time+(8-OFFSET*60*60) &gt; now()+(8-OFFSET*60*60)
            <if test="param.language!=null">
                and language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.master_id!=null">
                and master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>

    </select>

    <select id="queryByMessage" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.ids!=null and param.ids.size()>0">
                AND master_id in
                <foreach item="item" index="index" collection="param.ids" separator="," open="(" close=")">
                    #{item}
                </foreach>
            </if>
            <if test="param.loginIDs!=null and param.loginIDs.size()>0">
                AND master_id in
                <foreach item="item" index="index" collection="param.loginIDs" separator="," open="(" close=")">
                    #{item}
                </foreach>
            </if>
            <if test="param.start_time!=null and param.end_time!=null">
                AND end_time
                BETWEEN #{param.start_time,jdbcType=TIMESTAMP}
                AND #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title like concat('%',#{param.title,jdbcType=VARCHAR},'%')
            </if>
            <if test="param.language!=null">
                AND language like concat('%',#{param.language,jdbcType=VARCHAR},'%')
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        order by start_time desc limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryMechanismAppointmentCount" resultType="java.lang.Integer">
        SELECT COALESCE(count(1), 0)
        FROM `eg_master_appointment`
        <where>
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.status==null">
                AND status in (1,2,3)
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.type==null">
                and type='jointly_class' or type='mechanism_offline'
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="queryByMessageCount" resultType="java.lang.Integer">
        SELECT
        coalesce(count(1),0)
        FROM eg_master_appointment
        <where>
            <if test="param.ids!=null and param.ids.size()>0">
                AND master_id in
                <foreach item="item" index="index" collection="param.ids" separator="," open="(" close=")">
                    #{item}
                </foreach>
            </if>
            <if test="param.loginIDs!=null and param.loginIDs.size()>0">
                AND master_id in
                <foreach item="item" index="index" collection="param.loginIDs" separator="," open="(" close=")">
                    #{item}
                </foreach>
            </if>
            <if test="param.start_time!=null and param.end_time!=null">
                AND end_time
                BETWEEN #{param.start_time,jdbcType=TIMESTAMP}
                AND #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title like concat('%',#{param.title,jdbcType=VARCHAR},'%')
            </if>
            <if test="param.language!=null">
                AND language like concat('%',#{param.language,jdbcType=VARCHAR},'%')
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="querySettlementList" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null and param.end_time!=null">
                AND end_time between #{param.start_time,jdbcType=TIMESTAMP}
                AND #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.status==null">
                AND status = 2
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.type==null">
                AND (type = 'open_class' or type = 'single_class')
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_special==null">
                AND is_special = false
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        ORDER BY UNIX_TIMESTAMP(start_time)+(8-OFFSET*60*60) DESC limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="querySoonClass" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        select
        <include refid="Base_Column_List"/>
        from eg_master_appointment
        where
        NOW() &gt; DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE )
        and status = 1
        <if test="param.type!=null">
            AND type = #{param.type,jdbcType=VARCHAR}
        </if>
        <if test="param.mechanism_id!=null">
            AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
        </if>
        <if test="param.group_type!=null and param.group_type!=''">
            AND group_type = #{param.group_type,jdbcType=VARCHAR}
        </if>
        <if test="param.language!=null and param.language!=''">
            AND language = #{param.language,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type!=null">
            AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type==null">
            AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
            identity_type = '' )
        </if>
        <if test="param.master_set_price_id != null">
            AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
        </if>
        <if test="param.mechanism_class_id != null">
            AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
        </if>
        order by id desc limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="querySoonClassCount" resultType="java.lang.Integer">
        select
        coalesce(count(1),0)
        from eg_master_appointment
        where
        NOW() &gt; DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE )
        and status = 1
        <if test="param.type!=null">
            AND type = #{param.type,jdbcType=VARCHAR}
        </if>
        <if test="param.mechanism_id!=null">
            AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
        </if>
        <if test="param.group_type!=null and param.group_type!=''">
            AND group_type = #{param.group_type,jdbcType=VARCHAR}
        </if>
        <if test="param.language!=null and param.language!=''">
            AND language = #{param.language,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type!=null">
            AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type==null">
            AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
            identity_type = '' )
        </if>
        <if test="param.master_set_price_id != null">
            AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
        </if>
        <if test="param.mechanism_class_id != null">
            AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
        </if>
    </select>
    <select id="queryBeginList" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            NOW() &lt; DATE_ADD( end_time, INTERVAL 480- OFFSET*60 MINUTE )
            AND NOW() &gt; DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE )
            AND status = 3
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        ORDER BY end_time ASC,is_recording DESC limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryBeginListCount" resultType="java.lang.Integer">
        SELECT
        coalesce(count(1),0)
        FROM eg_master_appointment
        <where>
            now() between start_time+(8-OFFSET*60*60)
            and end_time+(8-OFFSET*60*60)
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="queryAppointmentCountByTime" resultType="java.lang.Integer">
        select
        coalesce(count(1),0)
        from eg_master_appointment
        where unix_timestamp(start_time) +(8-OFFSET*60*60) > #{param.start_time,jdbcType=TIMESTAMP}
        <if test="param.id!=null">
            AND id = #{param.id,jdbcType=BIGINT}
        </if>
        <if test="param.create_time!=null">
            AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
        </if>
        <if test="param.update_time!=null">
            AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
        </if>
        <if test="param.master_id!=null">
            AND master_id = #{param.master_id,jdbcType=BIGINT}
        </if>
        <if test="param.end_time!=null">
            AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
        </if>
        <if test="param.status!=null">
            AND status = #{param.status,jdbcType=INTEGER}
        </if>
        <if test="param.type!=null and param.type!=''">
            AND type = #{param.type,jdbcType=VARCHAR}
        </if>
        <if test="param.offset!=null">
            AND offset = #{param.offset,jdbcType=DECIMAL}
        </if>
        <if test="param.timezone_id!=null">
            AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
        </if>
        <if test="param.title!=null">
            AND title = #{param.title,jdbcType=VARCHAR}
        </if>
        <if test="param.group_id!=null">
            AND group_id = #{param.group_id,jdbcType=BIGINT}
        </if>
        <if test="param.cover!=null">
            AND cover = #{param.cover,jdbcType=VARCHAR}
        </if>
        <if test="param.age_grade!=null and param.age_grade!=''">
            AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
        </if>
        <if test="param.language_level!=null and param.language_level!=''">
            AND language_level = #{param.language_level,jdbcType=VARCHAR}
        </if>
        <if test="param.language!=null and param.language!=''">
            AND language = #{param.language,jdbcType=VARCHAR}
        </if>
        <if test="param.group_type!=null and param.group_type!=''">
            AND group_type = #{param.group_type,jdbcType=VARCHAR}
        </if>
        <if test="param.room_id!=null">
            AND room_id = #{param.room_id,jdbcType=VARCHAR}
        </if>
        <if test="param.classroom_type!=null and param.classroom_type!=''">
            AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
        </if>
        <if test="param.introduction_cover!=null">
            AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
        </if>
        <if test="param.introduction_content!=null">
            AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
        </if>
        <if test="param.connect_peoplenum!=null">
            AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
        </if>
        <if test="param.is_recording!=null">
            AND is_recording = #{param.is_recording,jdbcType=BIT}
        </if>
        <if test="param.service_type!=null">
            AND service_type = #{param.service_type,jdbcType=VARCHAR}
        </if>
        <if test="param.mechanism_id!=null">
            AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
        </if>
        <if test="param.amout!=null">
            AND amout = #{param.amout,jdbcType=DECIMAL}
        </if>
        <if test="param.discount!=null">
            AND discount = #{param.discount,jdbcType=DECIMAL}
        </if>
        <if test="param.discount_amout!=null">
            AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
        </if>
        <if test="param.is_discount!=null">
            AND is_discount = #{param.is_discount,jdbcType=BIT}
        </if>
        <if test="param.teach_program!=null">
            AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
        </if>
        <if test="param.latitude!=null">
            AND latitude = #{param.latitude,jdbcType=DECIMAL}
        </if>
        <if test="param.longitude!=null">
            AND longitude = #{param.longitude,jdbcType=DECIMAL}
        </if>
        <if test="param.recommend_type!=null">
            AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
        </if>
        <if test="param.identity_type!=null">
            AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
        </if>
        <if test="param.is_special!=null">
            AND is_special = #{param.is_special,jdbcType=BIT}
        </if>
        <if test="param.is_firstpage_show!=null">
            AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
        </if>
        <if test="param.identity_type!=null">
            AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type==null">
            AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
            identity_type = '' )
        </if>
        <if test="param.master_set_price_id != null">
            AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
        </if>
        <if test="param.mechanism_class_id != null">
            AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
        </if>
    </select>
    <select id="querySettlementListCount" resultType="java.lang.Integer">
        SELECT
        coalesce(count(1),0)
        FROM eg_master_appointment
        <where>
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null and param.end_time!=null">
                AND end_time between #{param.start_time,jdbcType=TIMESTAMP}
                AND #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.status==null">
                AND status = 2
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.type==null">
                AND (type = 'open_class' or type = 'single_class')
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_special==null">
                AND is_special = false
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="queryMechanismAppointmentListPageCount" resultType="java.lang.Integer">
        SELECT
        coalesce(count(1),0)
        FROM eg_master_appointment
        <where>
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.status==null">
                AND status in (1,2,3)
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.type==null">
                and type='jointly_class' or type='mechanism_offline'
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="queryHomeListPageBeginCount" resultType="java.lang.Integer">
        select
        coalesce(count(1),0)
        from (
        SELECT
        <include refid="Base_Column_List"/>
        <if test="param.latitude!=null and param.longitude!=null">
            ,(
            6371 * acos (
            cos (radians(
            #{param.latitude,jdbcType=DECIMAL}
            ))
            * cos( radians( t1.latitude ) )
            * cos( radians( t1.longitude ) - radians(
            #{param.longitude,jdbcType=DECIMAL}
            ))
            + sin ( radians(
            #{param.latitude,jdbcType=DECIMAL}
            )
            * sin( radians( t1.latitude ) )
            )
            )
            ) AS distance
        </if>
        FROM
        (
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        eg_master_appointment
        <where>
            NOW() BETWEEN DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE )
            AND DATE_ADD( end_time, INTERVAL 480- OFFSET*60 MINUTE )
            AND status = 3
            AND is_firstpage_show = true
            AND is_special = false
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.group_ids!=null and param.group_ids.size()>0">
                and group_id in
                <foreach item="group_id" index="index" collection="param.group_ids" open="(" separator="," close=")">
                    #{group_id,jdbcType=BIGINT}
                </foreach>
            </if>
        </where>
        ORDER BY
        recommend_type DESC,
        DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) DESC ) t1
        <if test="param.latitude!=null and param.longitude!=null">
            HAVING 50 > distance
        </if>
        )as num1
    </select>
    <select id="queryHomeListPageEndCount" resultType="java.lang.Integer">
        select coalesce(count(*),0) from(
        select
        <include refid="Base_Column_List"/>
        <if test="param.latitude!=null and param.longitude!=null">
            ,(
            6371 * acos (
            cos (radians(
            #{param.latitude,jdbcType=DECIMAL}
            )
            )
            * cos( radians( t2.latitude ) )
            * cos( radians( t2.longitude ) - radians(
            #{param.longitude,jdbcType=DECIMAL}
            ))
            + sin ( radians(
            #{param.latitude,jdbcType=DECIMAL}
            ))
            * sin( radians( t2.latitude ) )
            )
            ) AS distance
        </if>
        from (
        SELECT
        <include refid="Base_Column_List"/>
        FROM(
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        eg_master_appointment
        <where>
            NOW() > DATE_ADD( end_time,INTERVAL 480- OFFSET*60 MINUTE )
            AND is_recording = true
            AND is_firstpage_show = true
            AND is_special = false
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.group_ids!= null and param.group_ids.size()>0">
                and group_id in
                <foreach item="group_id" index="index" collection="param.group_ids" open="(" separator="," close=")">
                    #{group_id,jdbcType=BIGINT}
                </foreach>
            </if>
        </where>
        ORDER BY
        recommend_type DESC,
        DATE_ADD( end_time,INTERVAL 480- OFFSET*60 MINUTE) DESC
        )AS a
        GROUP by a.group_id
        ORDER BY
        recommend_type DESC,
        DATE_ADD( end_time,INTERVAL 480- OFFSET*60 MINUTE ) DESC
        ) t2
        <if test="param.latitude!=null and param.longitude!=null">
            HAVING 50 > distance
        </if>
        )as num2
    </select>
    <select id="queryHomeListPageNearCount" resultType="java.lang.Integer">
        select
        coalesce(count(*),0)
        from(
        SELECT
        <include refid="Base_Column_List"/>
        <if test="param.latitude!=null and param.longitude!=null">
            ,(
            6371 * acos (
            cos (radians(
            #{param.latitude,jdbcType=DECIMAL}
            )
            )
            * cos( radians( t3.latitude ) )
            * cos( radians( t3.longitude ) - radians(
            #{param.longitude,jdbcType=DECIMAL}
            ))
            + sin ( radians(
            (#{param.latitude,jdbcType=DECIMAL})
            ))
            * sin( radians( t3.latitude ))
            )
            ) AS distance
        </if>
        from (
        SELECT
        <include refid="Base_Column_List"/>
        FROM(
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        eg_master_appointment
        <where>
            DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) > NOW()
            AND is_firstpage_show = true
            AND is_special = false
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.group_ids!= null and param.group_ids.size()>0">
                and group_id in
                <foreach item="group_id" index="index" collection="param.group_ids" open="(" separator="," close=")">
                    #{group_id,jdbcType=BIGINT}
                </foreach>
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        ORDER BY
        recommend_type desc,
        DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) ASC
        )AS b
        GROUP by b.group_id
        ORDER BY
        recommend_type desc,
        DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) ASC
        )t3
        <if test="param.latitude!=null and param.longitude!=null">
            HAVING 50 > distance
        </if>
        <if test="param.latitude!=null and param.longitude!=null">
            ORDER BY distance ASC
        </if>
        )as num3
    </select>
    <select id="queryHomeListPageNearCountTotal" resultType="java.lang.Integer">
        SELECT
        coalesce(count(1),0)
        FROM
        eg_master_appointment
        <where>
            DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) > NOW()
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="queryDayCountAfterNow" resultType="java.lang.Integer">
        SELECT
        COALESCE( count(1),0)
        FROM `eg_master_appointment`
        where
        date_format(start_time,'%Y-%m-%d') = date_format(now(),'%Y-%m-%d')
        AND now() > start_time
        <if test="param.service_type!=null">
            and service_type = #{param.service_type,jdbcType=VARCHAR}
        </if>
        <if test="param.type!=null">
            and type = #{param.type,jdbcType=VARCHAR}
        </if>
        <if test="param.master_id!=null">
            and master_id = #{param.master_id,jdbcType=BIGINT}
        </if>
        <if test="param.is_special!=null">
            and is_special = #{param.is_special,jdbcType=BIT}
        </if>
        <if test="param.mechanism_id!=null">
            AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
        </if>
        <if test="param.group_type!=null and param.group_type!=''">
            AND group_type = #{param.group_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type!=null">
            AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
        </if>
        <if test="param.identity_type==null">
            AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
            identity_type = '' )
        </if>
    </select>
    <select id="queryScheduleListPage" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null and param.offset !=null and param.end_time!=null">
                AND unix_timestamp(start_time) BETWEEN
                unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
                AND unix_timestamp(#{param.end_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.type==null">
                AND (type ='single_class' or type = 'open_class' )
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.is_special != null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.student_id != null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id != null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        ORDER BY UNIX_TIMESTAMP(start_time)+(8-OFFSET*60*60)
        <if test="param.mechanism_id==null">
            limit #{param.startRow},#{param.pageSize}
        </if>
    </select>
    <select id="queryMechanismSchedule" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM(
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null and param.offset !=null and param.end_time!=null">
                AND unix_timestamp(start_time) BETWEEN
                unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
                AND unix_timestamp(#{param.end_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
            </if>
            <if test="param.start_time!=null and param.offset!=null and param.end_time==null">
                AND DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) &gt;
                DATE_ADD(#{param.start_time ,jdbcType=TIMESTAMP}, INTERVAL 480- #{param.offset,jdbcType=DECIMAL}*60
                MINUTE )
            </if>
            <if test="param.start_time==null and param.offset!=null and param.end_time!=null">
                AND DATE_ADD( end_time, INTERVAL 480- OFFSET*60 MINUTE ) &lt;
                DATE_ADD(#{param.end_time ,jdbcType=TIMESTAMP}, INTERVAL 480- #{param.offset,jdbcType=DECIMAL}*60 MINUTE
                )
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.is_special != null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.student_id != null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id != null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.create_type!=null">
                AND create_type = #{param.create_type,jdbcType=VARCHAR}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        GROUP BY title , start_time
        )a
        ORDER BY id DESC
    </select>
    <select id="queryEarnTotal" resultType="java.math.BigDecimal">
        SELECT COALESCE(SUM(profit),0)
        FROM eg_master_appointment
        <where>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="querydayEarn" resultType="java.math.BigDecimal">
        SELECT COALESCE(SUM(profit),0)
        FROM eg_master_appointment
        <where>
            DATE_FORMAT(NOW(),'%Y-%m-%d') = DATE_FORMAT(start_time,'%Y-%m-%d')
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="queryEarnList" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        select
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.start_time!=null">
                AND unix_timestamp(start_time) &gt;=
                unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP})
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.status==null">
                AND status in (8,9)
            </if>
        </where>
        ORDER BY id DESC
        limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryEndCourse" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM(
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null and param.offset !=null and param.end_time!=null">
                AND unix_timestamp(start_time) BETWEEN
                unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
                AND unix_timestamp(#{param.end_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
            </if>
            <if test="param.start_time!=null and param.offset!=null and param.end_time==null">
                AND DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) &gt;
                DATE_ADD(#{param.start_time ,jdbcType=TIMESTAMP}, INTERVAL 480- #{param.offset,jdbcType=DECIMAL}*60
                MINUTE )
            </if>
            <if test="param.start_time==null and param.offset!=null and param.end_time!=null">
                AND DATE_ADD( end_time, INTERVAL 480- OFFSET*60 MINUTE ) &lt;
                DATE_ADD(#{param.end_time ,jdbcType=TIMESTAMP}, INTERVAL 480- #{param.offset,jdbcType=DECIMAL}*60 MINUTE
                )
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.is_special != null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.student_id != null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id != null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.create_type!=null">
                AND create_type = #{param.create_type,jdbcType=VARCHAR}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        GROUP BY title , start_time
        )a
        ORDER BY id DESC
    </select>
    <select id="queryMechanismScheduleListPage" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM(
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null and param.offset !=null and param.end_time!=null">
                AND unix_timestamp(start_time) BETWEEN
                unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
                AND unix_timestamp(#{param.end_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
            </if>
            <if test="param.start_time!=null and param.offset!=null and param.end_time==null">
                AND DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) &gt;
                DATE_ADD(#{param.start_time ,jdbcType=TIMESTAMP}, INTERVAL 480- #{param.offset,jdbcType=DECIMAL}*60
                MINUTE )
            </if>
            <if test="param.start_time==null and param.offset!=null and param.end_time!=null">
                AND DATE_ADD( end_time, INTERVAL 480- OFFSET*60 MINUTE ) &lt;
                DATE_ADD(#{param.end_time ,jdbcType=TIMESTAMP}, INTERVAL 480- #{param.offset,jdbcType=DECIMAL}*60 MINUTE
                )
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.is_special != null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.student_id != null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id != null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.create_type!=null">
                AND create_type = #{param.create_type,jdbcType=VARCHAR}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        GROUP BY title , start_time
        )a
        ORDER BY id DESC
        limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="queryMechanismScheduleListPageCount" resultType="java.lang.Integer">
        SELECT
        coalesce(count(1),0)
        FROM(
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null and param.offset !=null and param.end_time!=null">
                AND unix_timestamp(start_time) BETWEEN
                unix_timestamp(#{param.start_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
                AND unix_timestamp(#{param.end_time,jdbcType=TIMESTAMP})+(offset-#{param.offset,jdbcType=DECIMAL})*60*60
            </if>
            <if test="param.start_time!=null and param.offset!=null and param.end_time==null">
                AND DATE_ADD( start_time, INTERVAL 480- OFFSET*60 MINUTE ) &gt;
                DATE_ADD(#{param.start_time ,jdbcType=TIMESTAMP}, INTERVAL 480- #{param.offset,jdbcType=DECIMAL}*60
                MINUTE )
            </if>
            <if test="param.start_time==null and param.offset!=null and param.end_time!=null">
                AND DATE_ADD( end_time, INTERVAL 480- OFFSET*60 MINUTE ) &lt;
                DATE_ADD(#{param.end_time ,jdbcType=TIMESTAMP}, INTERVAL 480- #{param.offset,jdbcType=DECIMAL}*60 MINUTE
                )
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.is_special != null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.student_id != null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id != null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.create_type!=null">
                AND create_type = #{param.create_type,jdbcType=VARCHAR}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        GROUP BY title , start_time
        )a
    </select>
    <select id="querySoonMechanismCourse" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            start_time BETWEEN DATE_SUB( NOW(), INTERVAL 1 HOUR )
            AND DATE_SUB(NOW(),INTERVAL 2 HOUR)
            AND status = 1
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.create_type!=null">
                AND create_type = #{param.create_type,jdbcType=VARCHAR}
            </if>
            <if test="param.identity_type==null">
                AND ( identity_type = 'major' or identity_type = 'cross_border' or identity_type = 'mother_tongue' or
                identity_type = '' )
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.group_name!=null">
                AND group_name = #{param.group_name,jdbcType=BIT}
            </if>
            <if test="param.student_id!=null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id!=null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <select id="queryStartTimeIn" resultType="java.lang.String">
        select classroom
        FROM eg_master_appointment
        where #{start_time,jdbcType=TIMESTAMP} BETWEEN
            start_time and end_time
          and mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
    </select>
    <select id="queryAsc" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.create_type!=null">
                AND create_type = #{param.create_type,jdbcType=VARCHAR}
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.group_name!=null">
                AND group_name = #{param.group_name,jdbcType=BIT}
            </if>
            <if test="param.student_id!=null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id!=null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id!=null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.categories!=null">
                AND categories = #{param.categories,jdbcType=VARCHAR}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
        ORDER BY id ASC
    </select>
    <select id="queryListPageAsc" resultType="com.huihe.eg.user.model.MasterAppointmentEntity">
        SELECT
        <include refid="Base_Column_List"/>
        FROM eg_master_appointment
        <where>
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.status!=null">
                AND status = #{param.status,jdbcType=INTEGER}
            </if>
            <if test="param.type!=null and param.type!=''">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.create_type!=null">
                AND create_type = #{param.create_type,jdbcType=VARCHAR}
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.group_name!=null">
                AND group_name = #{param.group_name,jdbcType=BIT}
            </if>
            <if test="param.student_id!=null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id!=null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id!=null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.categories!=null">
                AND categories = #{param.categories,jdbcType=VARCHAR}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
        </where>
        ORDER BY id ASC limit #{param.startRow},#{param.pageSize}
    </select>
    <select id="querylistpageNotIn1" resultType="java.lang.Integer">
        SELECT
        coalesce(count(0),0)
        FROM eg_master_appointment
        <where>
            status &lt;&gt; 1
            <if test="param.id!=null">
                AND id = #{param.id,jdbcType=BIGINT}
            </if>
            <if test="param.create_time!=null">
                AND create_time = #{param.create_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.update_time!=null">
                AND update_time = #{param.update_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.master_id!=null">
                AND master_id = #{param.master_id,jdbcType=BIGINT}
            </if>
            <if test="param.type!=null">
                AND type = #{param.type,jdbcType=VARCHAR}
            </if>
            <if test="param.start_time!=null">
                AND start_time = #{param.start_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.end_time!=null">
                AND end_time = #{param.end_time,jdbcType=TIMESTAMP}
            </if>
            <if test="param.timezone_id!=null">
                AND timezone_id = #{param.timezone_id,jdbcType=BIGINT}
            </if>
            <if test="param.title!=null">
                AND title = #{param.title,jdbcType=VARCHAR}
            </if>
            <if test="param.group_id!=null">
                AND group_id = #{param.group_id,jdbcType=BIGINT}
            </if>
            <if test="param.cover!=null">
                AND cover = #{param.cover,jdbcType=VARCHAR}
            </if>
            <if test="param.offset!=null">
                AND offset = #{param.offset,jdbcType=DECIMAL}
            </if>
            <if test="param.age_grade!=null and param.age_grade!=''">
                AND age_grade = #{param.age_grade,jdbcType=VARCHAR}
            </if>
            <if test="param.language_level!=null and param.language_level!=''">
                AND language_level = #{param.language_level,jdbcType=VARCHAR}
            </if>
            <if test="param.language!=null and param.language!=''">
                AND language = #{param.language,jdbcType=VARCHAR}
            </if>
            <if test="param.group_type!=null and param.group_type!=''">
                AND group_type = #{param.group_type,jdbcType=VARCHAR}
            </if>
            <if test="param.room_id!=null">
                AND room_id = #{param.room_id,jdbcType=VARCHAR}
            </if>
            <if test="param.classroom_type!=null and param.classroom_type!=''">
                AND classroom_type = #{param.classroom_type,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_cover!=null">
                AND introduction_cover = #{param.introduction_cover,jdbcType=VARCHAR}
            </if>
            <if test="param.introduction_content!=null">
                AND introduction_content = #{param.introduction_content,jdbcType=VARCHAR}
            </if>
            <if test="param.connect_peoplenum!=null">
                AND connect_peoplenum = #{param.connect_peoplenum,jdbcType=INTEGER}
            </if>
            <if test="param.is_recording!=null">
                AND is_recording = #{param.is_recording,jdbcType=BIT}
            </if>
            <if test="param.service_type!=null">
                AND service_type = #{param.service_type,jdbcType=VARCHAR}
            </if>
            <if test="param.mechanism_id!=null">
                AND mechanism_id = #{param.mechanism_id,jdbcType=BIGINT}
            </if>
            <if test="param.amout!=null">
                AND amout = #{param.amout,jdbcType=DECIMAL}
            </if>
            <if test="param.discount!=null">
                AND discount = #{param.discount,jdbcType=DECIMAL}
            </if>
            <if test="param.discount_amout!=null">
                AND discount_amout = #{param.discount_amout,jdbcType=DECIMAL}
            </if>
            <if test="param.is_discount!=null">
                AND is_discount = #{param.is_discount,jdbcType=BIT}
            </if>
            <if test="param.teach_program!=null">
                AND teach_program = #{param.teach_program,jdbcType=VARCHAR}
            </if>
            <if test="param.latitude!=null">
                AND latitude = #{param.latitude,jdbcType=DECIMAL}
            </if>
            <if test="param.longitude!=null">
                AND longitude = #{param.longitude,jdbcType=DECIMAL}
            </if>
            <if test="param.recommend_type!=null">
                AND recommend_type = #{param.recommend_type,jdbcType=INTEGER}
            </if>
            <if test="param.number_of_lessons!=null">
                AND number_of_lessons = #{param.number_of_lessons,jdbcType=INTEGER}
            </if>
            <if test="param.identity_type!=null">
                AND identity_type = #{param.identity_type,jdbcType=VARCHAR}
            </if>
            <if test="param.create_type!=null">
                AND create_type = #{param.create_type,jdbcType=VARCHAR}
            </if>
            <if test="param.is_special!=null">
                AND is_special = #{param.is_special,jdbcType=BIT}
            </if>
            <if test="param.is_firstpage_show!=null">
                AND is_firstpage_show = #{param.is_firstpage_show,jdbcType=BIT}
            </if>
            <if test="param.student_id!=null">
                AND student_id = #{param.student_id,jdbcType=BIGINT}
            </if>
            <if test="param.study_card_id!=null">
                AND study_card_id = #{param.study_card_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id!=null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
            <if test="param.categories!=null">
                AND categories = #{param.categories,jdbcType=VARCHAR}
            </if>
            <if test="param.is_appointment!=null">
                AND is_appointment = #{param.is_appointment,jdbcType=BIT}
            </if>
            <if test="param.master_set_price_id != null">
                AND master_set_price_id = #{param.master_set_price_id,jdbcType=BIGINT}
            </if>
            <if test="param.mechanism_class_id != null">
                AND mechanism_class_id = #{param.mechanism_class_id,jdbcType=BIGINT}
            </if>
        </where>
    </select>
    <update id="updateIsFirstpageShow">
        update eg_master_appointment
        set is_firstpage_show = #{is}
        where id = #{id}
    </update>
    <update id="updateByPrimaryKeySettlement">
        update eg_master_appointment
        set status = 5
        where id = #{param.id,jdbcType=BIGINT}
    </update>
    <update id="updateProfit">
        update eg_master_appointment
        set profit = #{param.profit,jdbcType=BIGINT}
        where id = #{param.id,jdbcType=BIGINT}
    </update>
    <update id="updateLikeCount">
        update eg_master_appointment
        set like_count=like_count + 1
        where id = #{id,jdbcType=BIGINT}
    </update>

    <update id="updateLikeCountCancel">
        update eg_master_appointment
        set like_count=like_count - 1
        where id = #{id,jdbcType=BIGINT}
    </update>

    <update id="updateShareCount">
        update eg_master_appointment
        set share_count=share_count + 1
        where id = #{id,jdbcType=BIGINT}
    </update>

    <update id="updateCommentCount">
        update eg_master_appointment
        set comment_count=comment_count + 1
        where id = #{id,jdbcType=BIGINT}
    </update>
</mapper>